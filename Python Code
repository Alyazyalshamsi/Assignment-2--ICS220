class EBook:
    """Represents an e-book in the bookstore."""
    
    def __init__(self, title, author, publication_date, genre, price):
        """Initializes an e-book with its details."""
        self.title = title
        self.author = author
        self.publication_date = publication_date
        self.genre = genre
        self.price = price
    
    def get_details(self):
        """Returns a dictionary of e-book details."""
        return {
            "Title": self.title,
            "Author": self.author,
            "Publication Date": self.publication_date,
            "Genre": self.genre,
            "Price": self.price
        }

    def __str__(self):
        """Returns a string representation of the e-book."""
        return f"{self.title} by {self.author} - {self.price} USD"

    def set_price(self, new_price):
        """Sets a new price for the e-book."""
        self.price = new_price
    
    def update_details(self, title=None, author=None, publication_date=None, genre=None, price=None):
        """Updates the details of the e-book."""
        if title:
            self.title = title
        if author:
            self.author = author
        if publication_date:
            self.publication_date = publication_date
        if genre:
            self.genre = genre
        if price is not None:
            self.price = price

class Customer:
    """Represents a customer in the bookstore."""
    
    def __init__(self, name, email, phone_number):
        """Initializes a customer with their details."""
        self.name = name
        self.email = email
        self.phone_number = phone_number
        self.is_loyalty_member = False
    
    def get_details(self):
        """Returns customer details."""
        return {
            "Name": self.name,
            "Email": self.email,
            "Phone Number": self.phone_number,
            "Loyalty Member": self.is_loyalty_member
        }
    
    def join_loyalty_program(self):
        """Enrolls the customer into the loyalty program."""
        self.is_loyalty_member = True
    
    def leave_loyalty_program(self):
        """Removes the customer from the loyalty program."""
        self.is_loyalty_member = False

class ShoppingCart:
    """Represents a shopping cart for a customer."""
    
    def __init__(self):
        """Initializes an empty shopping cart."""
        self.items = []
    
    def add_item(self, ebook):
        """Adds an e-book to the shopping cart."""
        if isinstance(ebook, EBook):
            self.items.append(ebook)

    def remove_item(self, ebook):
        """Removes an e-book from the shopping cart."""
        if ebook in self.items:
            self.items.remove(ebook)
    
    def update_quantity(self, ebook, quantity):
        """Updates the quantity of a specific e-book in the cart (simulated by adding/removing)."""
        self.remove_item(ebook)
        for _ in range(quantity):
            self.add_item(ebook)
    
    def get_cart_items(self):
        """Returns a list of all e-books in the cart."""
        return [str(item) for item in self.items]
    
    def calculate_total(self):
        """Calculates the total price of items in the cart."""
        return sum([item.price for item in self.items])


class Discount:
    """Handles discount calculations for loyalty and bulk purchases."""
    
    def __init__(self):
        """Initializes the discount calculation handler."""
        self.discount_percentage = 0
    
    def apply_loyalty_discount(self, customer):
        """Applies a loyalty discount if the customer is a loyalty member."""
        if customer.is_loyalty_member:
            self.discount_percentage = 10
        return self.discount_percentage
    
    def apply_bulk_discount(self, cart):
        """Applies a bulk discount for 5 or more e-books in the cart."""
        if len(cart.items) >= 5:
            self.discount_percentage = max(self.discount_percentage, 20)  # Bulk purchase gets a 20% discount
        return self.discount_percentage

